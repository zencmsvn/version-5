function parse_url_youtube(url) {
    var regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
    var match = url.match(regExp);
    if (match&&match[2].length==11){
        return match[2];
    }else{
        return false;
    }
}

tinymce.PluginManager.add("youtube", function (e) {
    function t() {
        e.windowManager.open({title: "Thêm video từ youtube", body: [{name: "url", type: "textbox", filetype: "file", size: 40, label: "Nhập link video"}], onSubmit: function (t) {
            var youtube_id = parse_url_youtube(t.data.url);
            if (youtube_id) {
                e.insertContent("\n<object width=\"425\" height=\"350\"><embed src=\"http://www.youtube.com/v/" + youtube_id + "\" type=\"application/x-shockwave-flash\" width=\"425\" height=\"350\"></embed></object>");
            }
            //e.insertContent("\n<textarea class=\"textarea_box\">" + htmlspecialchars(t.data.textarea) + "</textarea>")
        }})
    }
    e.addButton("youtube", {icon: "media", tooltip: "Thêm video youtube", onclick: t})
});